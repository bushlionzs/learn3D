/*$T Common/EncryptAriths/BitOper.h GC 1.140 10/10/07 10:06:29 */


/*$6
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 */


#ifndef __BIT_OPER__H__
#define __BIT_OPER__H__

#include "CryptDef.h"

class BitOperBase :
	public BlockTransformation
{
/*
 -----------------------------------------------------------------------------------------------------------------------
 -----------------------------------------------------------------------------------------------------------------------
 */
public:
	enum { KEYLENGTH = 16, BUFSIZE = 32 };

	/*
	 ===============================================================================================================
	 ===============================================================================================================
	 */
	uint32 BlockSize() const
	{
		return BUFSIZE;
	}

	void	SetUserKey(const uchar *key);

/*
 -----------------------------------------------------------------------------------------------------------------------
 -----------------------------------------------------------------------------------------------------------------------
 */
protected:
	char	m_szUserKey[KEYLENGTH];
};

class BitOperEncryption1 :
	public BitOperBase
{
/*
 -----------------------------------------------------------------------------------------------------------------------
 -----------------------------------------------------------------------------------------------------------------------
 */
public:

	/*
	 ===============================================================================================================
	 ===============================================================================================================
	 */
	void ProcessBlock(uchar *inoutBlock) const
	{
		BitOperEncryption1::ProcessBlock(inoutBlock, inoutBlock);
	}

	void	ProcessBlock(const uchar *inBlock, uchar *outBlock) const;
	void	SetUserKey(const uchar *key);
};

class BitOperDecryption1 :
	public BitOperBase
{
/*
 -----------------------------------------------------------------------------------------------------------------------
 -----------------------------------------------------------------------------------------------------------------------
 */
public:

	/*
	 ===============================================================================================================
	 ===============================================================================================================
	 */
	void ProcessBlock(uchar *inoutBlock) const
	{
		BitOperDecryption1::ProcessBlock(inoutBlock, inoutBlock);
	}

	void	ProcessBlock(const uchar *inBlock, uchar *outBlock) const;
	void	SetUserKey(const uchar *key);
};

class BitOperEncryption2 :
	public BitOperBase
{
/*
 -----------------------------------------------------------------------------------------------------------------------
 -----------------------------------------------------------------------------------------------------------------------
 */
public:

	/*
	 ===============================================================================================================
	 ===============================================================================================================
	 */
	void ProcessBlock(uchar *inoutBlock) const
	{
		BitOperEncryption2::ProcessBlock(inoutBlock, inoutBlock);
	}

	void	ProcessBlock(const uchar *inBlock, uchar *outBlock) const;
	void	SetUserKey(const uchar *key);
};

class BitOperDecryption2 :
	public BitOperBase
{
/*
 -----------------------------------------------------------------------------------------------------------------------
 -----------------------------------------------------------------------------------------------------------------------
 */
public:

	/*
	 ===============================================================================================================
	 ===============================================================================================================
	 */
	void ProcessBlock(uchar *inoutBlock) const
	{
		BitOperDecryption2::ProcessBlock(inoutBlock, inoutBlock);
	}

	void	ProcessBlock(const uchar *inBlock, uchar *outBlock) const;
	void	SetUserKey(const uchar *key);
};
#endif
