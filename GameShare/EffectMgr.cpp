/*$T Common/EffectMgr.cpp GC 1.140 10/10/09 10:06:27 */


/*$6
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 */


#include "stdafx.h"
#include "TAB.h"
#include "EffectMgr.h"

CEffectMgr *CEffectMgr::	s_pBuffImpactMgr = NULL;

/*
 =======================================================================================================================
 =======================================================================================================================
 */
CEffectMgr::CEffectMgr(void)
{
	m_pDBCFileLoad = NULL;
	m_pDataBase = NULL;
	s_pBuffImpactMgr = this;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
CEffectMgr::~CEffectMgr(void)
{
	s_pBuffImpactMgr = NULL;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
BOOL CEffectMgr::Init(const char *lpszPathName)
{
	/*~~~~~~~~~~~~*/
	BOOL	bResutl;
	/*~~~~~~~~~~~~*/

	m_pDBCFileLoad = new TAB::TABFile(UINT_MAX);
	bResutl = m_pDBCFileLoad->OpenFromTXT(lpszPathName);
	if(!bResutl) return FALSE;

	m_pDataBase = m_pDBCFileLoad;

	return TRUE;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
BOOL CEffectMgr::Init(const TAB::TABFile *pDataBase)
{
	m_pDBCFileLoad = NULL;
	m_pDataBase = pDataBase;
	return TRUE;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
void CEffectMgr::Term(void)
{
	m_pDataBase = NULL;
	if(m_pDBCFileLoad != NULL)
	{
		delete m_pDBCFileLoad;
		m_pDBCFileLoad = NULL;
	}
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
SBuffImpact *CEffectMgr::GetBuffImpact(uint32 dwID)
{
	/*~~~~~~~~~~~~~~~~~~*/
	SBuffImpact	*pSet;
	/*~~~~~~~~~~~~~~~~~~*/

	pSet = (SBuffImpact *) (m_pDataBase->Search_Index_EQU(dwID));
	return pSet;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
const SBuffImpact *CEffectMgr::GetConstBuffImpact(uint32 dwID) const
{
	return const_cast<CEffectMgr *>(this)->GetBuffImpact(dwID);
}
