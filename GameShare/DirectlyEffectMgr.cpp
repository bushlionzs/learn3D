/*$T Common/DirectlyEffectMgr.cpp GC 1.140 10/10/09 10:06:29 */


/*$6
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 */


#include "stdafx.h"
#include "TAB.h"
#include "DirectlyEffectMgr.h"

CDirectlyEffectMgr *CDirectlyEffectMgr::	s_pDirectlyImpactMgr = NULL;

/*
 =======================================================================================================================
 =======================================================================================================================
 */
CDirectlyEffectMgr::CDirectlyEffectMgr(void)
{
	m_pDBCFileLoad = NULL;
	m_pDataBase = NULL;
	s_pDirectlyImpactMgr = this;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
CDirectlyEffectMgr::~CDirectlyEffectMgr(void)
{
	Term();
	s_pDirectlyImpactMgr = NULL;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
BOOL CDirectlyEffectMgr::Init(const char *lpszPathName)
{
	/*~~~~~~~~~~~~*/
	BOOL	bResutl;
	/*~~~~~~~~~~~~*/

	m_pDBCFileLoad = new TAB::TABFile(UINT_MAX);
	bResutl = m_pDBCFileLoad->OpenFromTXT(lpszPathName);
	if(!bResutl) return FALSE;

	m_pDataBase = m_pDBCFileLoad;

	return TRUE;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
BOOL CDirectlyEffectMgr::Init(const TAB::TABFile *pDataBase)
{
	m_pDBCFileLoad = NULL;
	m_pDataBase = pDataBase;
	return TRUE;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
void CDirectlyEffectMgr::Term(void)
{
	m_pDataBase = NULL;
	if(m_pDBCFileLoad != NULL)
	{
		delete m_pDBCFileLoad;
		m_pDBCFileLoad = NULL;
	}
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
SDirectImpact *CDirectlyEffectMgr::GetDirectlyImpact(uint32 dwID)
{
	/*~~~~~~~~~~~~~~~~~~*/
	SDirectImpact	*pSet;
	/*~~~~~~~~~~~~~~~~~~*/

	pSet = (SDirectImpact *) (m_pDataBase->Search_Index_EQU(dwID));
	return pSet;
}

/*
 =======================================================================================================================
 =======================================================================================================================
 */
const SDirectImpact *CDirectlyEffectMgr::GetConstDirectlyImpact(uint32 dwID) const
{
	return const_cast<CDirectlyEffectMgr *>(this)->GetDirectlyImpact(dwID);
}
