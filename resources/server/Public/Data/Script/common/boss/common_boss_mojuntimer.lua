--功能：boss系统

--脚本号
x305040_g_ScriptId = 305040


x305040_g_CreatePositions = {
								{SceneId=	5	  ,posX=	60  ,posZ= 190	,MonsterType=	17000	,count=	1	,ai=	1	,aiscript=	902, title="完颜洪烈部将"	},	
								{SceneId=	5	  ,posX=	92  ,posZ= 131  ,MonsterType=	17001	,count=	1	,ai=	1	,aiscript=	902, title="完颜洪烈部将"	},	
								{SceneId=	5	  ,posX=  32  ,posZ= 103	,MonsterType=	17002	,count=	1	,ai=	1	,aiscript=	902, title="完颜洪烈部将"	},	
								{SceneId=	5	  ,posX=	30  ,posZ= 49	  ,MonsterType=	17003	,count=	1	,ai=	1	,aiscript=	902, title="完颜洪烈部将"	},	
								{SceneId=	5	  ,posX=	231 ,posZ= 126	,MonsterType=	17004	,count=	1	,ai=	1	,aiscript=	902, title="完颜洪烈部将"	},	
								{SceneId=	5	  ,posX=	230 ,posZ= 46   ,MonsterType=	17005	,count=	1	,ai=	1	,aiscript=	902, title="完颜洪烈部将"	},	
								{SceneId=	5	  ,posX=	152 ,posZ= 114  ,MonsterType=	17006	,count=	1	,ai=	1	,aiscript=	902, title="完颜洪烈部将"	},	
								{SceneId=	8	  ,posX=	26 	,posZ= 156	,MonsterType=	17007	,count=	1	,ai=	1	,aiscript=	903, title="屈出律部将"	},	
								{SceneId=	8	  ,posX=	224 ,posZ= 219  ,MonsterType=	17008	,count=	1	,ai=	1	,aiscript=	903, title="屈出律部将"	},	
								{SceneId=	8	  ,posX=	130 ,posZ= 103	,MonsterType=	17009	,count=	1	,ai=	1	,aiscript=	903, title="屈出律部将"	},	
								{SceneId=	8	  ,posX=  37 	,posZ= 70	  ,MonsterType=	17010	,count=	1	,ai=	1	,aiscript=	903, title="屈出律部将"},	
								{SceneId=	8	  ,posX=	70 	,posZ= 24	  ,MonsterType=	17011	,count=	1	,ai=	1	,aiscript=	903, title="屈出律部将"	},	
								{SceneId=	8	  ,posX=	123 ,posZ= 33	  ,MonsterType=	17012	,count=	1	,ai=	1	,aiscript=	903, title="屈出律部将"	},	
								{SceneId=	8	  ,posX=	183 ,posZ= 35   ,MonsterType=	17013	,count=	1	,ai=	1	,aiscript=	903, title="屈出律部将"	},						
								{SceneId=	11	,posX=	30 	,posZ= 243	,MonsterType=	17014	,count=	1	,ai=	1	,aiscript=	904, title="札兰丁部将"	},		
								{SceneId=	11	,posX=	149 ,posZ= 232	,MonsterType=	17015	,count=	1	,ai=	1	,aiscript=	904, title="札兰丁部将"	},		
								{SceneId=	11	,posX=	186 ,posZ= 84	  ,MonsterType=	17016	,count=	1	,ai=	1	,aiscript=	904, title="札兰丁部将"	},		
								{SceneId=	11	,posX=	207 ,posZ= 24	  ,MonsterType=	17017	,count=	1	,ai=	1	,aiscript=	904, title="札兰丁部将"	},	
								{SceneId=	11	,posX=	57 	,posZ= 26	  ,MonsterType=	17018	,count=	1	,ai=	1	,aiscript=	904, title="札兰丁部将"	},	
								{SceneId=	11	,posX=  75 	,posZ= 88   ,MonsterType=	17019	,count=	1	,ai=	1	,aiscript=	904, title="札兰丁部将"	},	
								{SceneId=	11	,posX=  124 ,posZ= 52	  ,MonsterType=	17020	,count=	1	,ai=	1	,aiscript=	904, title="札兰丁部将"	},	
								{SceneId=	17	,posX=	229 ,posZ= 213  ,MonsterType=	17021	,count=	1	,ai=	1	,aiscript=	902, title="弗拉基米尔部将"	},	
								{SceneId=	17	,posX=	161 ,posZ= 226	,MonsterType=	17022	,count=	1	,ai=	1	,aiscript=	902, title="弗拉基米尔部将"	},
								{SceneId=	17	,posX=	77 	,posZ= 226	,MonsterType=	17023	,count=	1	,ai=	1	,aiscript=	902, title="弗拉基米尔部将"	},	
								{SceneId=	17	,posX=	75 	,posZ= 184	,MonsterType=	17024	,count=	1	,ai=	1	,aiscript=	902, title="弗拉基米尔部将"	},	
								{SceneId=	17	,posX=	124 ,posZ= 116	,MonsterType=	17025	,count=	1	,ai=	1	,aiscript=	902, title="弗拉基米尔部将"	},	
								{SceneId=	17	,posX=	225 ,posZ= 119	,MonsterType=	17026	,count=	1	,ai=	1	,aiscript=	902, title="弗拉基米尔部将"	},	
								{SceneId=	17	,posX=  60  ,posZ=  39  ,MonsterType=	17027	,count=	1	,ai=	1	,aiscript=	902, title="弗拉基米尔部将"	},							
								{SceneId=	20	,posX=	135 ,posZ= 22   ,MonsterType=	17028	,count=	1	,ai=	1	,aiscript=	903, title="贝拉四世部将"	},	
								{SceneId=	20	,posX=	92  ,posZ= 40 	,MonsterType=	17029	,count=	1	,ai=	1	,aiscript=	903, title="贝拉四世部将"	},
								{SceneId=	20	,posX=	22 	,posZ= 107  ,MonsterType=	17030	,count=	1	,ai=	1	,aiscript=	903, title="贝拉四世部将"	},	
								{SceneId=	20	,posX=	102 ,posZ= 109	,MonsterType=	17031	,count=	1	,ai=	1	,aiscript=	903, title="贝拉四世部将"	},	
								{SceneId=	20	,posX=	86  ,posZ= 229	,MonsterType=	17032	,count=	1	,ai=	1	,aiscript=	903, title="贝拉四世部将"	},	
								{SceneId=	20	,posX=	46  ,posZ= 154	,MonsterType=	17033	,count=	1	,ai=	1	,aiscript=	903, title="贝拉四世部将"	},	
								{SceneId=	20	,posX=  167 ,posZ= 159  ,MonsterType=	17034	,count=	1	,ai=	1	,aiscript=	903, title="贝拉四世部将"	},
								
								{SceneId=	23	,posX=	217	,posZ=	36	,MonsterType=	17035	,count=	1	,ai=	1	,aiscript=	903, title="哈里发部将"},	
								{SceneId=	23	,posX=	192	,posZ=	87	,MonsterType=	17036	,count=	1	,ai=	1	,aiscript=	903, title="哈里发部将"	},	
								{SceneId=	23	,posX=	41	,posZ=	85	,MonsterType=	17037	,count=	1	,ai=	1	,aiscript=	903, title="哈里发部将"	},	
								{SceneId=	23	,posX=	23	,posZ=	152 ,MonsterType=	17038	,count=	1	,ai=	1	,aiscript=	903, title="哈里发部将"	},						
								{SceneId=	23	,posX=	161	,posZ=	221	,MonsterType=	17039	,count=	1	,ai=	1	,aiscript=	903, title="哈里发部将"	},
								{SceneId=	23	,posX=	223	,posZ=	184 ,MonsterType=	17040	,count=	1	,ai=	1	,aiscript=	903, title="哈里发部将"	},
								{SceneId=	23	,posX=  125 ,posZ=	34	,MonsterType=	17041	,count=	1	,ai=	1	,aiscript=	903, title="哈里发部将"	},	
								--{SceneId=	23	,posX=	91	,posZ=	107	,MonsterType=	3205	,count=	1	,ai=	1	,aiscript=	904, title="埃及之王"	},	
								--{SceneId=	23	,posX=	133	,posZ=	63	,MonsterType=	3211	,count=	1	,ai=	1	,aiscript=	908, title="西域之王"	},	
								--{SceneId=	23	,posX=	163	,posZ=	93	,MonsterType=	3200	,count=	1	,ai=	1	,aiscript=	903, title="沙漠之王"	},	
								--{SceneId=	23	,posX=	190	,posZ=	125	,MonsterType=	3213	,count=	1	,ai=	1	,aiscript=	908, title="恒河之王"	},	
								--{SceneId=	23	,posX=	75	,posZ=	123	,MonsterType=	3201	,count=	1	,ai=	1	,aiscript=	902, title="大河之王"	},	
								--{SceneId=	23	,posX=	72	,posZ=	64	,MonsterType=	3214	,count=	1	,ai=	1	,aiscript=	907, title="巴格达之王"	},	 
								--{SceneId=	23	,posX=	152	,posZ=	73 	,MonsterType=	3215	,count=	1	,ai=	1	,aiscript=	907, title="顿河之王"	},	
							}


function x305040_OnTimerDoingStart( SceneId, actId, Param1, Param2, Param3, Param4, Param5 )
	if SceneId ~= 5 and SceneId ~= 8 and SceneId ~= 11 and SceneId ~= 17  and SceneId ~= 20 and SceneId ~= 23 then
			return
	end
	for i, item in x305040_g_CreatePositions do
		if item.SceneId == SceneId then
			-- 开始创建NPC
			for j=1, item.count do
					local r = random(1,3)
					if r < 1 then 
						r = 1 
					end
					if r > 3 then 
						r = 3
					end
					
					local rx = random(-3,3)
					local x = item.posX + rx
					local rz = random(-3,3)
					local z = item.posZ + rz
					local objId, objGuid =CreateMonster( SceneId, item.MonsterType, x, z, item.ai, item.aiscript, x305040_g_ScriptId, -1, 21, 30*60*1000, 0, "", item.title)
			end	
		end
	end
end


function x305040_OnDie(sceneId, selfId, killerId)
	
	if IsObjValid( sceneId,killerId ) ~=1 then
		return
	end
	
	-- 判断是否是宠物
	if GetObjType(sceneId, killerId) == 3 then
		killerId = GetMasterObjId(sceneId, killerId)
		if killerId == nil then
			return
		end
	end
	local title = GetName(sceneId,selfId)
	local killerName = GetName(sceneId,killerId)
	local countryId = GetCurCountry(sceneId, killerId)
	local countryName = GetCountryName(countryId)
	local scenename = GetSceneInfo(sceneId,"NAME")
	local msg1 = "魔君部将"..title.."被"..countryName..killerName.."在"..scenename.."击败！"
	local msg2 = title.."已被击败！"
	--LuaAllScenceM2Wrold(sceneId, msg1, CHAT_PLANE_SCROLL, 1)
	LuaAllScenceM2Wrold(sceneId, msg1, CHAT_LEFTDOWN, 1)
	--LuaAllScenceM2Wrold(sceneId, msg2, CHAT_MAIN_RIGHTDOWN, 1)

	GamePlayScriptLog(sceneId, killerId, 501)	
end