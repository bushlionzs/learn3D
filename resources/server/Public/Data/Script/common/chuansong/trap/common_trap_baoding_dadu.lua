--大都南路通往大都

x300474_g_ScriptId = 300474
x300474_g_TransPos="baoding2dadu"
x300474_g_Notice = "您的等级还不足#R40级#Y，无法前往中原大都！"

--玩家进入一个 area 时触发
function x300474_ProcAreaEntered( sceneId, selfId, zoneId, MissionId )

	local selfType = GetObjType(sceneId, selfId)
	
	if selfType == 1 then 
		------------------------------------------------------
		if IsHaveSpecificImpact( sceneId, selfId, 7610) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7607) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7608) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7605) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7616) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7613) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7614) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7611) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7622) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7619) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7620) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7617) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7628) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7625) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7626) == 1 or IsHaveSpecificImpact( sceneId, selfId, 7623) == 1 then
			Msg2Player(sceneId,selfId,"很抱歉，未完成铁人三项任务时无法通往其他场景！",8,2)
			return
		end
		--以上用于铁人三项禁止传送的处理
		------------------------------------------------------
		if IsHaveSpecificImpact(sceneId, selfId,7702) == 1 then
			Msg2Player(sceneId,selfId,"很抱歉，身负战旗无法进入中原大都！",8,2)
			return
		end
		--以上用于异国夺旗禁止进入大都的处理
		------------------------------------------------------
	end
	
	if selfType == 9 then	--Bus进入区域 把bus和bus里的人跨场景
		local busType = GetBusType(sceneId, selfId)
		if busType == 1 then --BUS_TYPE_NORMAL
			local memberCount = GetBusMemberCount(sceneId, selfId)
			local daduSceneId = 0
			ReadyBusChangeScene(sceneId, daduSceneId, selfId)--注意：此步骤是必需的.BUS切换场景，要先做些准备工作,
			for	i = 0, memberCount - 1 do
				local ObjID = GetBusMemberObjId(sceneId, selfId, i)
				CallScriptFunction(COMMON_CHUANSONG_NORMAL, "TransferToWorld",sceneId,ObjID,x300474_g_TransPos)
			end
			--删除BUS,但乘员仍在车上
			DeleteBus(sceneId, selfId,0)
			return
		end
	elseif selfType == 1 then	--玩家
--		local isBusMember = IsBusMember(sceneId, selfId)
--		if isBusMember == 1 then
--			return
--		end
	end
	
	local strText = ""
	local CanTrans = IsCashboxState(sceneId,selfId)	
	if CanTrans == 1 then
		BeginQuestEvent(sceneId)
			strText = "#Y运镖或者护送状态中，不允许传送"
			AddQuestText(sceneId,strText);
		EndQuestEvent(sceneId)
		DispatchQuestTips(sceneId,selfId)
		return
	end
	
	local nLevel = GetLevel(sceneId, selfId)
	if nLevel < 10 then 
		Msg2Player(sceneId,selfId,"#Y"..x300474_g_Notice.."#W",4,3)
	else	
		CallScriptFunction(COMMON_CHUANSONG_NORMAL, "TransferToWorld",sceneId,selfId,x300474_g_TransPos)
	end
	
end

--玩家在一个 area 呆了一段时间没走则定时触发
function x300474_ProcTiming( sceneId, monsterobjid )

end

--玩家离开一个 area 时触发
function x300474_ProcAreaLeaved( sceneId, monsterobjid, ScriptId, MissionId )

end


function x300474_ProcEventEntry( sceneId, monsterobjid )

end

